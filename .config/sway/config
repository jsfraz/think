# Logo key. Use Mod1 for Alt.
set $mod Mod4
# Home row direction keys, like vim
set $left h
set $down j
set $up k
set $right l
# Terminal emulator
set $term alacritty
# rofi
set $power ~/.config/rofi/scripts/power.sh
set $settings ~/.config/rofi/scripts/settings.sh
set $launcher rofi -show drun -theme ~/.config/rofi/launcher.rasi -show-icons -icon-theme $(gsettings get org.gnome.desktop.interface icon-theme | tr -d "'")
# Screensaver
set $screensaver_timeout_seconds 600
set $mouse_hide_timeout_milliseconds 600000
set $lock_timeout_seconds 1200

# Get current windows:
# swaymsg -t get_tree

# Color schema
include colors.conf

### Swayfx
corner_radius 15

# alacritty blur
for_window [app_id="Alacritty"] {
    blur enable;
    blur_ignore_transparent enable;
    blur_passes 2;
    blur_radius 2;
}

# rofi blur
layer_effects "rofi" {
    blur enable;
    blur_ignore_transparent enable;
}

# ags blur
layer_effects "gtk4-layer-shell" {
    blur enable;
    blur_ignore_transparent enable;
}

# notificaions blur
layer_effects "notifications" {
    blur enable;
    blur_ignore_transparent enable;
}

### Gaps and borders
gaps inner 10
smart_borders enable
smart_gaps disable

### Floating windows
for_window [app_id="zenity"] {
    floating enable;
}

for_window [app_id="nm-connection-editor"] {
    floating enable;
}

for_window [app_id="qalculate"] {
    floating enable;
}

for_window [class="MEGAsync"] {
    floating enable;
}

### Screensaver terminal fullscreen
for_window [app_id="screensaver"] {
    fullscreen enable;
} 

### Autostart
exec ~/.config/sway/scripts/matugen.sh && ~/.config/sway/scripts/exec.sh
exec_always ~/.config/sway/scripts/exec_always.sh

### Idle configuration

# Hide mouse cursor when idle
seat * hide_cursor $mouse_hide_timeout_milliseconds
# Screensaver and locking
exec swayidle -w \
        timeout $screensaver_timeout_seconds 'swaymsg "exec ~/.config/sway/scripts/screensaver.sh"' \
        resume 'swaymsg "[app_id=screensaver] kill"' \
        timeout $lock_timeout_seconds 'swaymsg "output * power off" && swaymsg "[app_id=screensaver] kill" && ~/.config/sway/scripts/lockscreen.sh' \
        resume 'swaymsg "output * power on"'

### Input

input "type:touchpad" {
    tap enabled
    natural_scroll enabled
}

input "*" {
    xkb_layout cz
    # xkb_options grp:win_space_toggle,compose:ralt
}

### Basic key bindings

# Start a terminal
bindsym $mod+Return exec $term
# Kill focused window
bindsym $mod+Shift+q kill
# Power menu
bindsym $mod+a exec $power
# Settings
bindsym $mod+s exec $settings
# Launcher
bindsym $mod+d exec $launcher
# Matugen
bindsym $mod+Shift+m exec ~/.config/sway/scripts/matugen.sh && swaymsg reload
# Autoclick
bindsym $mod+c exec ~/.config/sway/scripts/autoclick_toggle.sh
# Drag floating windows by holding down $mod and left mouse button.
# Resize them with right mouse button + $mod.
# Despite the name, also works for non-floating windows.
# Change normal to inverse to use left mouse button for resizing and right
# mouse button for dragging.
floating_modifier $mod normal
# Reload the configuration file
bindsym $mod+Shift+c reload
# Exit sway (logs you out of your Wayland session)
bindsym $mod+Shift+e exec swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -B 'Yes, exit sway' 'swaymsg exit'

### Moving around:
# Move your focus around
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right
# Or use $mod+[up|down|left|right]
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# Move the focused window with the same, but add Shift
bindsym $mod+Shift+$left move left
bindsym $mod+Shift+$down move down
bindsym $mod+Shift+$up move up
bindsym $mod+Shift+$right move right
# Ditto, with arrow keys
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

### Workspaces
# Mapping for czech keyboard: https://github.com/swaywm/sway/issues/922#issuecomment-255465289

# Switch to workspace
bindsym $mod+plus workspace 1
bindsym $mod+ecaron workspace 2
bindsym $mod+scaron workspace 3
bindsym $mod+ccaron workspace 4
bindsym $mod+rcaron workspace 5
bindsym $mod+zcaron workspace 6
bindsym $mod+yacute workspace 7
bindsym $mod+aacute workspace 8
bindsym $mod+iacute workspace 9
bindsym $mod+eacute workspace 0
# Move focused container to workspace
bindsym $mod+Shift+plus move container to workspace 1
bindsym $mod+Shift+ecaron move container to workspace 2
bindsym $mod+Shift+scaron move container to workspace 3
bindsym $mod+Shift+ccaron move container to workspace 4
bindsym $mod+Shift+rcaron move container to workspace 5
bindsym $mod+Shift+zcaron move container to workspace 6
bindsym $mod+Shift+yacute move container to workspace 7
bindsym $mod+Shift+aacute move container to workspace 8
bindsym $mod+Shift+iacute move container to workspace 9
bindsym $mod+Shift+eacute move container to workspace 0
# Note: workspaces can have any name you want, not just numbers.

### Layout stuff:

# You can "split" the current object of your focus with
# $mod+b or $mod+v, for horizontal and vertical splits
# respectively.
bindsym $mod+b splith
bindsym $mod+v splitv
# Switch the current container between different layout styles
# bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split
# Make the current focus fullscreen
bindsym $mod+f fullscreen
# Toggle the current focus between tiling and floating mode
bindsym $mod+Shift+space floating toggle
# Swap focus between the tiling area and the floating area
bindsym $mod+space focus mode_toggle
# Move focus to the parent container
# bindsym $mod+a focus parent

### Scratchpad:

# Sway has a "scratchpad", which is a bag of holding for windows.
# You can send windows there and get them back later.

# Move the currently focused window to the scratchpad
bindsym $mod+Shift+minus move scratchpad
# Show the next scratchpad window or hide the focused scratchpad window.
# If there are multiple scratchpad windows, this command cycles through them.
bindsym $mod+minus scratchpad show

### Resizing containers:

mode "resize" {
    # left will shrink the containers width
    # right will grow the containers width
    # up will shrink the containers height
    # down will grow the containers height
    bindsym $left resize shrink width 10px
    bindsym $down resize grow height 10px
    bindsym $up resize shrink height 10px
    bindsym $right resize grow width 10px

    # Ditto, with arrow keys
    bindsym Left resize shrink width 10px
    bindsym Down resize grow height 10px
    bindsym Up resize shrink height 10px
    bindsym Right resize grow width 10px

    # Return to default mode
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+r mode "resize"

### Utilities:

# Sink volume toggle mute
bindsym XF86AudioMute exec swayosd-client --output-volume mute-toggle
# Source volume toggle mute
bindsym XF86AudioMicMute exec swayosd-client --input-volume mute-toggle
# Sink volume raise with custom value optionally with --device
bindsym XF86AudioRaiseVolume exec swayosd-client --output-volume +5
# Sink volume lower with custom value optionally with --device
bindsym XF86AudioLowerVolume exec swayosd-client --output-volume -5
# Capslock (If you don't want to use the backend)
bindsym --release Caps_Lock exec swayosd-client --caps-lock
# Brightness raise with custom value('+' sign needed)
bindsym XF86MonBrightnessUp  exec swayosd-client --brightness +5
# Brightness lower with custom value('-' sign needed)
bindsym XF86MonBrightnessDown exec swayosd-client --brightness -5
# Play/Pause current player
bindsym XF86AudioPlay exec swayosd-client --playerctl play-pause
# Next song for current player
bindsym XF86AudioNext exec swayosd-client --playerctl next
# Screenshot with grim
bindsym Print exec grim -g "$(slurp)" -t png - | wl-copy -t image/png
